"use strict";(self.webpackChunkiobroker_vis_widgets_react_collection=self.webpackChunkiobroker_vis_widgets_react_collection||[]).push([["src_StateCollectionWidget_StateCollectionWidget_jsx"],{7963:(e,t,o)=>{o.r(t),o.d(t,{default:()=>f});var i=o(8437),a=o(6211),n=o(7613),l=o(9966),s=o(900),c=o(7051),r=o(7085),d=o(4657),v=o(4802),u=o(6255),p=o(6016),h=o(579);const m=function(e){var t,o,a,n;const{widgetStates:l,data:s,open:d,closeHandler:m}=e,{widget:g,values:x,setState:b,setValue:y,oidObject:C,getPropertyValue:f}=(0,i.useContext)(p.C),w=null===C||void 0===C?void 0:C._id,A=null===C||void 0===C||null===(t=C.common)||void 0===t?void 0:t.states,S=null===C||void 0===C||null===(o=C.common)||void 0===o?void 0:o.type,j=g.data.sampleInterval?g.data.sampleIntervalValue:g.data.delay,{debouncedValue:k,sampledValue:_}=(0,u.A)(f("oid"),j);(0,i.useEffect)((()=>{g.data.sampleInterval||void 0===k||y(w,k)}),[k,w,y,g.data.sampleInterval]),(0,i.useEffect)((()=>{g.data.sampleInterval&&void 0!==_&&y(w,_)}),[_,w,y,g.data.sampleInterval]);const I=(0,i.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(S){case"number":b(null===t?{values:(0,c.A)((0,c.A)({},x),{},{["".concat(w,".val")]:e})}:{values:(0,c.A)((0,c.A)({},x),{},{["".concat(w,".val")]:Number(t)})});break;case"string":b({values:(0,c.A)((0,c.A)({},x),{},{["".concat(w,".val")]:String(t)})});break;case"boolean":b({values:(0,c.A)((0,c.A)({},x),{},{["".concat(w,".val")]:/^true$/i.test(t)})})}}),[w,S,b,x]),V="number"!==S||g.data.onlyStates||void 0===(null===C||void 0===C||null===(a=C.common)||void 0===a?void 0:a.min)||void 0===(null===C||void 0===C||null===(n=C.common)||void 0===n?void 0:n.max)?null:(0,h.jsx)(r.Slider,{sx:{pb:A?4:3},size:"small",min:C.common.min,max:C.common.max,marks:[{value:C.common.min,label:String(C.common.min)},{value:C.common.max,label:String(C.common.max)}],valueLabelDisplay:"auto",value:f("oid")||0,onChange:(e,t)=>I(t)}),W=l?(0,h.jsx)(r.List,{children:Object.entries(l).map((e=>{let[t,o]=e;return(0,h.jsx)(r.ListItem,{disablePadding:!0,children:(0,h.jsx)(r.ListItemButton,{disableGutters:!0,onClick:()=>I(o,t),children:(0,h.jsx)(r.ListItemText,{sx:{px:2},primaryTypographyProps:{variant:"body2"},primary:o})})},t)}))}):null;return(0,h.jsxs)(r.Dialog,{open:d,onClose:m,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{}},children:[(0,h.jsx)(r.DialogTitle,{sx:{m:0,p:2},id:"customized-dialog-title",children:s.header||C.common.name}),(0,h.jsx)(r.IconButton,{"aria-label":"close",onClick:m,sx:e=>({position:"absolute",right:8,top:8,color:e.palette.grey[500]}),children:(0,h.jsx)(v.A,{})}),(0,h.jsx)(r.DialogContent,{sx:{overflow:"unset"},children:(0,h.jsxs)(r.Stack,{divider:Object.keys(l).length&&(0,h.jsx)(r.Divider,{flexItem:!0}),sx:{px:2},spacing:0,component:r.Paper,children:[V,W]})})]})};var g=o(2152),x=o(5001),b=o(5702);const y=function(){var e;const{setValue:t,widget:o,oidObject:a}=(0,i.useContext)(p.C),{data:n,widgetStates:l}=(0,g.A)("oid"),s=(0,x.A)("oid"),v=(s||0===s||!1===s)&&"".concat(s).concat(o.data.unit),[u,y]=(0,i.useState)(!1),{textStyles:C,fontStyles:f}=(0,b.A)(o.style),w=null===a||void 0===a?void 0:a._id,A=null===a||void 0===a||null===(e=a.common)||void 0===e?void 0:e.type,S=o.data.onlyStates,j=(0,i.useCallback)((()=>{switch(A){case"boolean":S?y(!0):t(w,!s);break;case"number":case"string":y(!0)}}),[A,w,s,t,S]),k=(0,h.jsx)(r.Button,{disabled:o.data.noButton,onClick:j,sx:{overflow:"hidden",width:"100%",height:"100%",color:n.iconColorActive||n.iconColor||n.textColorActive||n.textColor,"&:hover":{bgcolor:"transparent",filter:n.iconHoverActive&&"brightness(".concat(n.iconHoverActive,")")||n.iconHover&&"brightness(".concat(n.iconHover,")")}},children:(0,h.jsx)(r.Avatar,{variant:"square",src:n.iconActive||n.icon,slotProps:{img:{style:{objectFit:"contain"}}},sx:{overflow:"hidden",width:"calc(100% * ".concat(n.iconSizeOnly||100," / 100)"),height:"calc(100% * ".concat(n.iconSizeOnly||100," / 100)"),bottom:n.iconYOffset,left:n.iconXOffset,bgcolor:"transparent",color:n.iconColorActive||n.iconColor,filter:(n.iconActive||n.icon)&&(n.iconColorActive||n.iconColor)&&"drop-shadow(0px 10000px 0)",transform:(n.iconActive||n.icon)&&(n.iconColorActive||n.iconColor)&&"translateY(-10000px)",display:n.icon?null:"flex"},children:(0,h.jsx)(r.Typography,{variant:"body2",sx:(0,c.A)((0,c.A)((0,c.A)({},f),C),{},{fontSize:n.valueSizeActive||n.valueSize,bgcolor:"transparent",color:n.textColorActive||n.textColor,textTransform:"none"}),children:(!n.iconActive||!n.icon)&&(n.alias||n.value||v)})})});return(0,h.jsxs)(h.Fragment,{children:[u&&(0,h.jsx)(m,{data:n,widgetStates:l,open:u,closeHandler:()=>y(!1)}),(0,h.jsx)(d.A,{data:n,oidValue:s,children:(0,h.jsx)(r.Box,{sx:{overflow:"hidden",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:k})})]})};class C extends a.A{static getWidgetInfo(){return{id:"tplStateCollectionWidget",visSet:"vis-2-widgets-collection",visSetLabel:"widgets_collection",visSetColor:"#0C0A43",visName:"StateCollectionWidget",visWidgetLabel:"state_collection_widget",visAttrs:[(0,l.A)(),{name:"button",label:"group_button",fields:[{name:"onlyStates",type:"checkbox",label:"only_states",default:!1,hidden:"!data.values_count"},{name:"noButton",type:"checkbox",label:"no_button",disabled:"!data.write",default:"!data.write",hidden:"!data.write"},{name:"noIcon",type:"checkbox",label:"no_icon"}]},(0,n.A)("values")],visDefaultStyle:{width:"100%",height:"100px",position:"relative"},visPrev:"widgets/vis-2-widgets-collection/img/prev-collection-state.png"}}getWidgetInfo(){return C.getWidgetInfo()}async propertiesUpdate(){const e=JSON.stringify(this.state.rxData);this.lastRxData!==e&&(this.lastRxData=e,await this.createStateObjectAsync("oid"))}async onRxDataChanged(e){await this.propertiesUpdate()}onRxStyleChanged(){}onStateUpdated(e,t){}async componentDidMount(){super.componentDidMount(),await this.propertiesUpdate()}renderWidgetBody(e){super.renderWidgetBody(e);const t={id:e.id,refService:e.refService,style:e.style,widget:e.widget,setValue:this.setValue,setState:this.setState.bind(this),oidObject:this.state.oidObject,values:this.state.values,isSignalVisible:this.isSignalVisible.bind(this),getPropertyValue:this.getPropertyValue.bind(this),mode:this.props.context.themeType,socket:this.props.context.socket,theme:this.props.context.theme,wrappedContent:this.wrappedContent};return e.widget.data.noCard||e.widget.usedInWidget?this.wrappedContent=!1:this.wrappedContent=!0,(0,s.A)(this.wrapContent((0,h.jsx)(y,{})),t)}}const f=C},4802:(e,t,o)=>{var i=o(2613);t.A=void 0;var a=i(o(39)),n=o(579);t.A=(0,a.default)((0,n.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")}}]);
//# sourceMappingURL=src_StateCollectionWidget_StateCollectionWidget_jsx.8f08cf70.chunk.js.map