"use strict";(self.webpackChunkiobroker_vis_widgets_react_collection=self.webpackChunkiobroker_vis_widgets_react_collection||[]).push([["src_StateCollectionWidget_StateCollectionWidget_jsx"],{7963:(t,e,o)=>{o.r(e),o.d(e,{default:()=>C});var i=o(7051),a=o(8437),n=o(6211),l=o(7613),s=o(9966),c=o(900),r=o(7085),d=o(4657),v=o(4802),u=o(6255),p=o(6016),h=o(579);const m=function(t){var e,o,n,l;const{widgetStates:s,data:c,open:d,closeHandler:m}=t,{widget:x,values:g,setState:b,setValue:y,oidObject:A,getPropertyValue:C}=(0,a.useContext)(p.C),f=null===A||void 0===A?void 0:A._id,w=null===A||void 0===A||null===(e=A.common)||void 0===e?void 0:e.states,S=null===A||void 0===A||null===(o=A.common)||void 0===o?void 0:o.type,j=x.data.sampleInterval?x.data.sampleIntervalValue:x.data.delay,{debouncedValue:k,sampledValue:_}=(0,u.A)(C("oid"),j);(0,a.useEffect)((()=>{x.data.sampleInterval||void 0===k||y(f,k)}),[k,f,y,x.data.sampleInterval]),(0,a.useEffect)((()=>{x.data.sampleInterval&&void 0!==_&&y(f,_)}),[_,f,y,x.data.sampleInterval]);const I=(0,a.useCallback)((function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(S){case"number":b(null===e?{values:(0,i.A)((0,i.A)({},g),{},{["".concat(f,".val")]:t})}:{values:(0,i.A)((0,i.A)({},g),{},{["".concat(f,".val")]:Number(e)})});break;case"string":b({values:(0,i.A)((0,i.A)({},g),{},{["".concat(f,".val")]:String(e)})});break;case"boolean":b({values:(0,i.A)((0,i.A)({},g),{},{["".concat(f,".val")]:/^true$/i.test(e)})})}}),[f,S,b,g]),D="number"!==S||x.data.onlyStates||void 0===(null===A||void 0===A||null===(n=A.common)||void 0===n?void 0:n.min)||void 0===(null===A||void 0===A||null===(l=A.common)||void 0===l?void 0:l.max)?null:(0,h.jsx)(r.Slider,{sx:{pb:w?4:3},size:"small",min:A.common.min,max:A.common.max,marks:[{value:A.common.min,label:String(A.common.min)},{value:A.common.max,label:String(A.common.max)}],valueLabelDisplay:"auto",value:C("oid")||0,onChange:(t,e)=>I(e)}),V=s?(0,h.jsx)(r.List,{children:Object.entries(s).map((t=>{let[e,o]=t;return(0,h.jsx)(r.ListItem,{disablePadding:!0,children:(0,h.jsx)(r.ListItemButton,{disableGutters:!0,onClick:()=>I(o,e),children:(0,h.jsx)(r.ListItemText,{sx:{px:2},primaryTypographyProps:{variant:"body2"},primary:o})})},e)}))}):null;return(0,h.jsxs)(r.Dialog,{open:d,onClose:m,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{}},children:[(0,h.jsx)(r.DialogTitle,{sx:{m:0,p:2},id:"customized-dialog-title",children:c.header||A.common.name}),(0,h.jsx)(r.IconButton,{"aria-label":"close",onClick:m,sx:t=>({position:"absolute",right:8,top:8,color:t.palette.grey[500]}),children:(0,h.jsx)(v.A,{})}),(0,h.jsx)(r.DialogContent,{sx:{overflow:"unset"},children:(0,h.jsxs)(r.Stack,{divider:Object.keys(s).length&&(0,h.jsx)(r.Divider,{flexItem:!0}),sx:{px:2},spacing:0,component:r.Paper,children:[D,V]})})]})};var x=o(2152),g=o(5001),b=o(5702);const y=function(){var t;const{setValue:e,widget:o,oidObject:n}=(0,a.useContext)(p.C),{data:l,widgetStates:s}=(0,x.A)("oid"),c=(0,g.A)("oid"),v=(c||0===c||!1===c)&&"".concat(c).concat(o.data.unit),[u,y]=(0,a.useState)(!1),{textStyles:A,fontStyles:C}=(0,b.A)(o.style),f=null===n||void 0===n?void 0:n._id,w=null===n||void 0===n||null===(t=n.common)||void 0===t?void 0:t.type,S=o.data.onlyStates,j=(0,a.useCallback)((()=>{switch(w){case"boolean":S?y(!0):e(f,!c);break;case"number":case"string":y(!0)}}),[w,f,c,e,S]),k=(0,h.jsx)(r.Button,{disabled:o.data.noButton,onClick:j,sx:{overflow:"hidden",width:"100%",height:"100%",color:l.iconColorActive||l.iconColor||l.textColorActive||l.textColor,"&:hover":{bgcolor:"transparent",filter:l.iconHoverActive&&"brightness(".concat(l.iconHoverActive,")")||l.iconHover&&"brightness(".concat(l.iconHover,")")}},children:(0,h.jsx)(r.Avatar,{variant:"square",src:l.iconActive||l.icon,slotProps:{img:{style:{objectFit:"contain"}}},sx:{overflow:"hidden",width:"calc(100% * ".concat(l.iconSizeOnly||100," / 100)"),height:"calc(100% * ".concat(l.iconSizeOnly||100," / 100)"),bottom:l.iconYOffset,left:l.iconXOffset,bgcolor:"transparent",color:l.iconColorActive||l.iconColor,filter:(l.iconActive||l.icon)&&(l.iconColorActive||l.iconColor)&&"drop-shadow(0px 10000px 0)",transform:(l.iconActive||l.icon)&&(l.iconColorActive||l.iconColor)&&"translateY(-10000px)",display:l.icon?null:"flex"},children:(0,h.jsx)(r.Typography,{variant:"body2",sx:(0,i.A)((0,i.A)((0,i.A)({},C),A),{},{fontSize:l.valueSizeActive||l.valueSize,bgcolor:"transparent",color:l.textColorActive||l.textColor,textTransform:"none"}),children:(!l.iconActive||!l.icon)&&(l.alias||l.value||v)})})});return(0,h.jsxs)(h.Fragment,{children:[u&&(0,h.jsx)(m,{data:l,widgetStates:s,open:u,closeHandler:()=>y(!1)}),(0,h.jsx)(d.A,{data:l,oidValue:c,children:(0,h.jsx)(r.Box,{sx:{overflow:"hidden",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:k})})]})};class A extends n.A{static getWidgetInfo(){return{id:"tplStateCollectionWidget",visSet:"vis-2-widgets-collection",visSetLabel:"widgets_collection",visSetColor:"#0C0A43",visName:"StateCollectionWidget",visWidgetLabel:"state_collection_widget",visAttrs:[(0,s.A)(),{name:"button",label:"group_button",fields:[{name:"onlyStates",type:"checkbox",label:"only_states",default:!1,hidden:"!data.values_count"},{name:"noButton",type:"checkbox",label:"no_button",disabled:"!data.write",default:"!data.write",hidden:"!data.write"},{name:"noIcon",type:"checkbox",label:"no_icon"}]},(0,l.A)("values")],visDefaultStyle:{width:"100%",height:"100px",position:"relative"},visPrev:"widgets/vis-2-widgets-collection/img/prev-collection-state.png"}}getWidgetInfo(){return A.getWidgetInfo()}async propertiesUpdate(){const t=JSON.stringify(this.state.rxData);this.lastRxData!==t&&(this.lastRxData=t,await this.createStateObjectAsync("oid"))}async onRxDataChanged(t){await this.propertiesUpdate()}onRxStyleChanged(){}onStateUpdated(t,e){}async componentDidMount(){super.componentDidMount(),await this.propertiesUpdate()}renderWidgetBody(t){super.renderWidgetBody(t);const e={id:t.id,refService:t.refService,style:t.style,widget:(0,i.A)((0,i.A)({},t.widget),{},{data:this.state.rxData,style:this.state.rxStyle}),setValue:this.setValue,setState:this.setState.bind(this),oidObject:this.state.oidObject,values:this.state.values,isSignalVisible:this.isSignalVisible.bind(this),getPropertyValue:this.getPropertyValue.bind(this),mode:this.props.context.themeType,socket:this.props.context.socket,theme:this.props.context.theme,wrappedContent:this.wrappedContent};return t.widget.data.noCard||t.widget.usedInWidget?this.wrappedContent=!1:this.wrappedContent=!0,(0,c.A)(this.wrapContent((0,h.jsx)(y,{})),e)}}const C=A},4802:(t,e,o)=>{var i=o(2613);e.A=void 0;var a=i(o(39)),n=o(579);e.A=(0,a.default)((0,n.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")}}]);
//# sourceMappingURL=src_StateCollectionWidget_StateCollectionWidget_jsx.f5bd7b02.chunk.js.map